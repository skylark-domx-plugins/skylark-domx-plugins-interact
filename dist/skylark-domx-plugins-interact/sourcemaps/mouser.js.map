{"version":3,"sources":["mouser.js"],"names":["define","datax","plugins","interact","Mouser","Plugin","inherit","klassName","pluginName","options","cancel","distance","delay","started","moving","stopped","capture","_construct","elm","prototype","call","this","_startedCallback","_movingCallback","_stoppedCallback","_captureCallback","listenTo","mousedown","_mouseDown","click","_click","event","data","target","removeData","stopImmediatePropagation","_mouseMoved","_mouseStarted","_mouseUp","_mouseDownEvent","that","which","mouseDelayMet","_mouseDelayTimer","setTimeout","_mouseDistanceMet","_mouseDelayMet","preventDefault","_startX","screenX","_startY","screenY","document","mousemove","_mouseMove","mouseup","_domx","eventer","stop","deltaX","deltaY","button","unlistenTo","clearTimeout","_mouseHandled","Math","max","abs","pageX","pageY","register"],"mappings":"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","file":"../mouser.js","sourcesContent":["define( [\r\n\t\"skylark-domx-data\",\r\n\t\"skylark-domx-plugins-base\",\r\n    \"./interact\"\r\n],function(datax,plugins, interact) {\r\n\r\n\tvar Mouser = plugins.Plugin.inherit({\r\n\t\tklassName : \"Mouser\",\r\n\r\n\t\tpluginName : \"lark.interact.mouser\",\r\n\r\n\t\toptions: {\r\n\t\t\tcancel: \"input, textarea, button, select, option\",\r\n\t\t\tdistance: 1,\r\n\t\t\tdelay: 0,\r\n\r\n\t\t\t// These are placeholder methods, to be overriden by caller\r\n\t\t\tstarted: function( /* event */ ) {},\r\n\t\t\tmoving: function( /* event */ ) {},\r\n\t\t\tstopped: function( /* event */ ) {},\r\n\t\t\tcapture: function( /* event */ ) { return true; }\r\n\t\t},\r\n\r\n        _construct : function (elm, options) {\r\n            plugins.Plugin.prototype._construct.call(this,elm,options);\r\n\r\n            options = this.options;\r\n            this._startedCallback = options.started; \r\n            this._movingCallback = options.moving;\r\n            this._stoppedCallback = options.stopped;\r\n            this._captureCallback = options.capture;\r\n\r\n\t\t\tthis.listenTo({\r\n\t\t\t\t\"mousedown\" : this._mouseDown,\r\n\t\t\t\t\"click\" : this._click\r\n\t\t\t});\r\n\r\n\t\t\tthis.started = false;\r\n\r\n        },\r\n\r\n\t\t_click : function(event) {\r\n\t\t\tif ( true === datax.data( event.target, this.pluginName + \".preventClickEvent\" ) ) {\r\n\t\t\t\tdatax.removeData( event.target, this.pluginName + \".preventClickEvent\" );\r\n\t\t\t\tevent.stopImmediatePropagation();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_mouseDown: function( event ) {\r\n    \t\tthis._mouseMoved = false;\r\n\r\n\t\t\t// We may have missed mouseup (out of window)\r\n\t\t\tif (this._mouseStarted) {\r\n\t\t\t\tthis._mouseUp(event);\t\r\n\t\t\t} \r\n\r\n\t\t\tthis._mouseDownEvent = event;\r\n\r\n\t\t\tvar that = this,\r\n\t\t\t\tbtnIsLeft = ( event.which === 1 );\r\n\r\n\t\t\t\t// event.target.nodeName works around a bug in IE 8 with\r\n\t\t\t\t// disabled inputs (#7620)\r\n\t\t\t\t////elIsCancel = ( typeof this.options.cancel === \"string\" && event.target.nodeName ?\r\n\t\t\t\t///$( event.target).closest( this.options.cancel ).length : false );\r\n\t\t\t///if ( !btnIsLeft || elIsCancel || !this._captureCallback( event )) {\r\n\t\t\tif ( !btnIsLeft  || !this._captureCallback( event )) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tthis.mouseDelayMet = !this.options.delay;\r\n\t\t\tif ( !this.mouseDelayMet ) {\r\n\t\t\t\tthis._mouseDelayTimer = setTimeout( function() {\r\n\t\t\t\t\tthat.mouseDelayMet = true;\r\n\t\t\t\t}, this.options.delay );\r\n\t\t\t}\r\n\r\n\t\t\tif ( this._mouseDistanceMet( event ) && this._mouseDelayMet( event ) ) {\r\n\t\t\t\tthis._mouseStarted = ( this._startedCallback( event ) !== false );\r\n\t\t\t\tif ( !this._mouseStarted ) {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Click event may never have fired (Gecko & Opera)\r\n\t\t\tif ( true === datax.data( event.target, this.pluginName + \".preventClickEvent\" ) ) {\r\n\t\t\t\tdatax.removeData( event.target, this.pluginName + \".preventClickEvent\" );\r\n\t\t\t}\r\n\r\n\t\t\t// These delegates are required to keep context\r\n\t\t\t/*\r\n\t\t\tthis._mouseMoveDelegate = function( event ) {\r\n\t\t\t\treturn that._mouseMove( event );\r\n\t\t\t};\r\n\t\t\tthis._mouseUpDelegate = function( event ) {\r\n\t\t\t\treturn that._mouseUp( event );\r\n\t\t\t};\r\n\r\n\t\t\t$doc\r\n\t\t\t\t.on( \"mousemove.\" + this.pluginName, this._mouseMoveDelegate )\r\n\t\t\t\t.on( \"mouseup.\" + this.pluginName, this._mouseUpDelegate );\r\n\t\t\t*/\r\n\r\n\t\t\tthis._startX = event.screenX;\r\n            this._startY = event.screenY;\r\n\r\n\t\t\tthis.listenTo(document,{\r\n\t\t\t\tmousemove : this._mouseMove,\r\n\t\t\t\tmouseup : this._mouseUp\r\n\t\t\t})\r\n\r\n\t\t\tthis._domx.eventer.stop(event);\r\n\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\t_mouseMove: function( event ) {\r\n            event.deltaX = event.screenX - this._startX;\r\n            event.deltaY = event.screenY - this._startY;\r\n\r\n\t\t\tif ( event.which || event.button ) {\r\n\t\t\t\tthis._mouseMoved = true;\r\n\t\t\t}\r\n\r\n\t\t\tif ( this._mouseStarted ) {\r\n\t\t\t\tthis._movingCallback( event );\r\n\t\t\t\treturn event.preventDefault();\r\n\t\t\t}\r\n\r\n\t\t\tif ( this._mouseDistanceMet( event ) && this._mouseDelayMet( event ) ) {\r\n\t\t\t\tthis._mouseStarted =\r\n\t\t\t\t\t( this._startedCallback( this._mouseDownEvent, event ) !== false );\r\n\t\t\t\tif(this._mouseStarted) {\r\n\t\t\t\t\tthis._movingCallback( event );\t\r\n\t\t\t\t}  else {\r\n\t\t\t\t\tthis._mouseUp( event )\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\treturn !this._mouseStarted;\r\n\t\t},\r\n\r\n\t\t_mouseUp: function( event ) {\r\n\t\t\tthis.unlistenTo(document);\r\n\r\n\t\t\tif ( this._mouseStarted ) {\r\n\t\t\t\tthis._mouseStarted = false;\r\n\r\n\t\t\t\tif ( event.target === this._mouseDownEvent.target ) {\r\n\t\t\t\t\tdatax.data( event.target, this.pluginName + \".preventClickEvent\", true );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._stoppedCallback( event );\r\n\t\t\t}\r\n\r\n\t\t\tif ( this._mouseDelayTimer ) {\r\n\t\t\t\tclearTimeout( this._mouseDelayTimer );\r\n\t\t\t\tdelete this._mouseDelayTimer;\r\n\t\t\t}\r\n\r\n\t\t\tthis._mouseHandled = false;\r\n\t\t\tevent.preventDefault();\r\n\t\t},\r\n\r\n\t\t_mouseDistanceMet: function( event ) {\r\n\t\t\treturn ( Math.max(\r\n\t\t\t\t\tMath.abs( this._mouseDownEvent.pageX - event.pageX ),\r\n\t\t\t\t\tMath.abs( this._mouseDownEvent.pageY - event.pageY )\r\n\t\t\t\t) >= this.options.distance\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t_mouseDelayMet: function( /* event */ ) {\r\n\t\t\treturn this.mouseDelayMet;\r\n\t\t}\r\n\t});\r\n\r\n\r\n\tplugins.register(Mouser);\r\n\r\n\treturn interact.Mouser = Mouser;\r\n});\r\n"]}