{"version":3,"sources":["mouser.js"],"names":["define","datax","plugins","interact","Mouser","Plugin","inherit","klassName","pluginName","options","cancel","distance","delay","started","moving","stopped","capture","_construct","elm","this","overrided","_startedCallback","_movingCallback","_stoppedCallback","_captureCallback","listenTo","mousedown","_mouseDown","click","_click","event","data","target","removeData","stopImmediatePropagation","_mouseMoved","_mouseStarted","_mouseUp","_mouseDownEvent","that","btnIsLeft","which","elIsCancel","nodeName","$","closest","length","mouseDelayMet","_mouseDelayTimer","setTimeout","_mouseDistanceMet","_mouseDelayMet","preventDefault","document","mousemove","_mouseMove","mouseup","_domx","eventer","stop","button","unlistenTo","clearTimeout","mouseHandled","Math","max","abs","pageX","pageY","register"],"mappings":";;;;;;;AAAAA,QACC,oBACA,4BACG,cACF,SAASC,EAAMC,EAASC,GAEzB,IAAIC,EAASF,EAAQG,OAAOC,SAC3BC,UAAY,SAEZC,WAAa,uBAEbC,SACCC,OAAQ,0CACRC,SAAU,EACVC,MAAO,EAGPC,QAAS,aACTC,OAAQ,aACRC,QAAS,aACTC,QAAS,WAA0B,OAAO,IAGrCC,WAAa,SAAUC,EAAKT,GACxBU,KAAKC,UAAUF,EAAIT,GAEnBA,EAAUU,KAAKV,QAEfU,KAAKE,iBAAmBZ,EAAQI,QAChCM,KAAKG,gBAAkBb,EAAQK,OAC/BK,KAAKI,iBAAmBd,EAAQM,QAChCI,KAAKK,iBAAmBf,EAAQO,QAEzCG,KAAKM,UACJC,UAAcP,KAAKQ,WACnBC,MAAUT,KAAKU,SAGhBV,KAAKN,SAAU,GAIhBgB,OAAS,SAASC,GACjB,IAAK,IAAS7B,EAAM8B,KAAMD,EAAME,OAAQb,KAAKX,WAAa,sBAGzD,OAFAP,EAAMgC,WAAYH,EAAME,OAAQb,KAAKX,WAAa,sBAClDsB,EAAMI,4BACC,GAITP,WAAY,SAAUG,GAClBX,KAAKgB,aAAc,EAGlBhB,KAAKiB,eACRjB,KAAKkB,SAASP,GAGfX,KAAKmB,gBAAkBR,EAEvB,IAAIS,EAAOpB,KACVqB,EAA8B,IAAhBV,EAAMW,MAIpBC,IAA8C,iBAAxBvB,KAAKV,QAAQC,SAAuBoB,EAAME,OAAOW,WACtEC,EAAGd,EAAME,QAAQa,QAAS1B,KAAKV,QAAQC,QAASoC,OAClD,QAAMN,IAAaE,GAAevB,KAAKK,iBAAkBM,MAIzDX,KAAK4B,eAAiB5B,KAAKV,QAAQG,MAC7BO,KAAK4B,gBACV5B,KAAK6B,iBAAmBC,WAAY,WACnCV,EAAKQ,eAAgB,GACnB5B,KAAKV,QAAQG,QAGZO,KAAK+B,kBAAmBpB,IAAWX,KAAKgC,eAAgBrB,KAC5DX,KAAKiB,eAAqD,IAAnCjB,KAAKE,iBAAkBS,IACxCX,KAAKiB,gBACVN,EAAMsB,kBACC,KAKJ,IAASnD,EAAM8B,KAAMD,EAAME,OAAQb,KAAKX,WAAa,uBACzDP,EAAMgC,WAAYH,EAAME,OAAQb,KAAKX,WAAa,sBAiBnDW,KAAKM,SAAS4B,UACbC,UAAYnC,KAAKoC,WACjBC,QAAUrC,KAAKkB,WAGhBlB,KAAKsC,MAAMC,QAAQC,KAAK7B,IAEjB,KAGRyB,WAAY,SAAUzB,GAKrB,OAJKA,EAAMW,OAASX,EAAM8B,UACzBzC,KAAKgB,aAAc,GAGfhB,KAAKiB,eACTjB,KAAKG,gBAAiBQ,GACfA,EAAMsB,mBAGTjC,KAAK+B,kBAAmBpB,IAAWX,KAAKgC,eAAgBrB,KAC5DX,KAAKiB,eACuD,IAAzDjB,KAAKE,iBAAkBF,KAAKmB,gBAAiBR,GAC7CX,KAAKiB,cACPjB,KAAKG,gBAAiBQ,GAEtBX,KAAKkB,SAAUP,KAITX,KAAKiB,gBAGdC,SAAU,SAAUP,GACnBX,KAAK0C,WAAWR,UAEXlC,KAAKiB,gBACTjB,KAAKiB,eAAgB,EAEhBN,EAAME,SAAWb,KAAKmB,gBAAgBN,QAC1C/B,EAAM8B,KAAMD,EAAME,OAAQb,KAAKX,WAAa,sBAAsB,GAGnEW,KAAKI,iBAAkBO,IAGnBX,KAAK6B,mBACTc,aAAc3C,KAAK6B,yBACZ7B,KAAK6B,kBAGbe,cAAe,EACfjC,EAAMsB,kBAGPF,kBAAmB,SAAUpB,GAC5B,OAASkC,KAAKC,IACZD,KAAKE,IAAK/C,KAAKmB,gBAAgB6B,MAAQrC,EAAMqC,OAC7CH,KAAKE,IAAK/C,KAAKmB,gBAAgB8B,MAAQtC,EAAMsC,SACzCjD,KAAKV,QAAQE,UAIpBwC,eAAgB,WACf,OAAOhC,KAAK4B,iBAOd,OAFA7C,EAAQmE,SAASjE,GAEVD,EAASC,OAASA","file":"../mouser.js","sourcesContent":["define( [\r\n\t\"skylark-domx-data\",\r\n\t\"skylark-domx-plugins-base\",\r\n    \"./interact\"\r\n],function(datax,plugins, interact) {\r\n\r\n\tvar Mouser = plugins.Plugin.inherit({\r\n\t\tklassName : \"Mouser\",\r\n\r\n\t\tpluginName : \"lark.interact.mouser\",\r\n\r\n\t\toptions: {\r\n\t\t\tcancel: \"input, textarea, button, select, option\",\r\n\t\t\tdistance: 1,\r\n\t\t\tdelay: 0,\r\n\r\n\t\t\t// These are placeholder methods, to be overriden by caller\r\n\t\t\tstarted: function( /* event */ ) {},\r\n\t\t\tmoving: function( /* event */ ) {},\r\n\t\t\tstopped: function( /* event */ ) {},\r\n\t\t\tcapture: function( /* event */ ) { return true; }\r\n\t\t},\r\n\r\n        _construct : function (elm, options) {\r\n            this.overrided(elm,options);\r\n\r\n            options = this.options;\r\n\r\n            this._startedCallback = options.started; \r\n            this._movingCallback = options.moving;\r\n            this._stoppedCallback = options.stopped;\r\n            this._captureCallback = options.capture;\r\n\r\n\t\t\tthis.listenTo({\r\n\t\t\t\t\"mousedown\" : this._mouseDown,\r\n\t\t\t\t\"click\" : this._click\r\n\t\t\t});\r\n\r\n\t\t\tthis.started = false;\r\n\r\n        },\r\n\r\n\t\t_click : function(event) {\r\n\t\t\tif ( true === datax.data( event.target, this.pluginName + \".preventClickEvent\" ) ) {\r\n\t\t\t\tdatax.removeData( event.target, this.pluginName + \".preventClickEvent\" );\r\n\t\t\t\tevent.stopImmediatePropagation();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_mouseDown: function( event ) {\r\n    \t\tthis._mouseMoved = false;\r\n\r\n\t\t\t// We may have missed mouseup (out of window)\r\n\t\t\tif (this._mouseStarted) {\r\n\t\t\t\tthis._mouseUp(event);\t\r\n\t\t\t} \r\n\r\n\t\t\tthis._mouseDownEvent = event;\r\n\r\n\t\t\tvar that = this,\r\n\t\t\t\tbtnIsLeft = ( event.which === 1 ),\r\n\r\n\t\t\t\t// event.target.nodeName works around a bug in IE 8 with\r\n\t\t\t\t// disabled inputs (#7620)\r\n\t\t\t\telIsCancel = ( typeof this.options.cancel === \"string\" && event.target.nodeName ?\r\n\t\t\t\t\t$( event.target).closest( this.options.cancel ).length : false );\r\n\t\t\tif ( !btnIsLeft || elIsCancel || !this._captureCallback( event )) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tthis.mouseDelayMet = !this.options.delay;\r\n\t\t\tif ( !this.mouseDelayMet ) {\r\n\t\t\t\tthis._mouseDelayTimer = setTimeout( function() {\r\n\t\t\t\t\tthat.mouseDelayMet = true;\r\n\t\t\t\t}, this.options.delay );\r\n\t\t\t}\r\n\r\n\t\t\tif ( this._mouseDistanceMet( event ) && this._mouseDelayMet( event ) ) {\r\n\t\t\t\tthis._mouseStarted = ( this._startedCallback( event ) !== false );\r\n\t\t\t\tif ( !this._mouseStarted ) {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Click event may never have fired (Gecko & Opera)\r\n\t\t\tif ( true === datax.data( event.target, this.pluginName + \".preventClickEvent\" ) ) {\r\n\t\t\t\tdatax.removeData( event.target, this.pluginName + \".preventClickEvent\" );\r\n\t\t\t}\r\n\r\n\t\t\t// These delegates are required to keep context\r\n\t\t\t/*\r\n\t\t\tthis._mouseMoveDelegate = function( event ) {\r\n\t\t\t\treturn that._mouseMove( event );\r\n\t\t\t};\r\n\t\t\tthis._mouseUpDelegate = function( event ) {\r\n\t\t\t\treturn that._mouseUp( event );\r\n\t\t\t};\r\n\r\n\t\t\t$doc\r\n\t\t\t\t.on( \"mousemove.\" + this.pluginName, this._mouseMoveDelegate )\r\n\t\t\t\t.on( \"mouseup.\" + this.pluginName, this._mouseUpDelegate );\r\n\t\t\t*/\r\n\r\n\t\t\tthis.listenTo(document,{\r\n\t\t\t\tmousemove : this._mouseMove,\r\n\t\t\t\tmouseup : this._mouseUp\r\n\t\t\t})\r\n\r\n\t\t\tthis._domx.eventer.stop(event);\r\n\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\t_mouseMove: function( event ) {\r\n\t\t\tif ( event.which || event.button ) {\r\n\t\t\t\tthis._mouseMoved = true;\r\n\t\t\t}\r\n\r\n\t\t\tif ( this._mouseStarted ) {\r\n\t\t\t\tthis._movingCallback( event );\r\n\t\t\t\treturn event.preventDefault();\r\n\t\t\t}\r\n\r\n\t\t\tif ( this._mouseDistanceMet( event ) && this._mouseDelayMet( event ) ) {\r\n\t\t\t\tthis._mouseStarted =\r\n\t\t\t\t\t( this._startedCallback( this._mouseDownEvent, event ) !== false );\r\n\t\t\t\tif(this._mouseStarted) {\r\n\t\t\t\t\tthis._movingCallback( event );\t\r\n\t\t\t\t}  else {\r\n\t\t\t\t\tthis._mouseUp( event )\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\treturn !this._mouseStarted;\r\n\t\t},\r\n\r\n\t\t_mouseUp: function( event ) {\r\n\t\t\tthis.unlistenTo(document);\r\n\r\n\t\t\tif ( this._mouseStarted ) {\r\n\t\t\t\tthis._mouseStarted = false;\r\n\r\n\t\t\t\tif ( event.target === this._mouseDownEvent.target ) {\r\n\t\t\t\t\tdatax.data( event.target, this.pluginName + \".preventClickEvent\", true );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._stoppedCallback( event );\r\n\t\t\t}\r\n\r\n\t\t\tif ( this._mouseDelayTimer ) {\r\n\t\t\t\tclearTimeout( this._mouseDelayTimer );\r\n\t\t\t\tdelete this._mouseDelayTimer;\r\n\t\t\t}\r\n\r\n\t\t\tmouseHandled = false;\r\n\t\t\tevent.preventDefault();\r\n\t\t},\r\n\r\n\t\t_mouseDistanceMet: function( event ) {\r\n\t\t\treturn ( Math.max(\r\n\t\t\t\t\tMath.abs( this._mouseDownEvent.pageX - event.pageX ),\r\n\t\t\t\t\tMath.abs( this._mouseDownEvent.pageY - event.pageY )\r\n\t\t\t\t) >= this.options.distance\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t_mouseDelayMet: function( /* event */ ) {\r\n\t\t\treturn this.mouseDelayMet;\r\n\t\t}\r\n\t});\r\n\r\n\r\n\tplugins.register(Mouser);\r\n\r\n\treturn interact.Mouser = Mouser;\r\n});\r\n"]}